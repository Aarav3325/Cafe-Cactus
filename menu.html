<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="icon" sizes="192x192" href="/img/logo.png" />
    <link rel="stylesheet" href="/css/newmenu.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }
    </style>
</head>

<body>
    <header>
        <div class="promo-bar">
            <div class="container">
                <p><strong>Get 5% Off on your first order, PROMOCODE: FIRST5</strong></p>
            </div>
        </div>
        <div class="container">
            <div class="nav-container">
                <div class="logo">
                    <img src="/img/logo.png" alt="Cafe Cactus Logo">
                    <h1 style="color: whitesmoke;">Cafe Cactus</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="/menu.html" class="active">Menu</a></li>
                        <li><a href="#">Orders</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </nav>
                <div class="user-cart">
                    <a href="/cart.html" style="text-decoration: none;">
                        <div class="cart-btn">
                            <div class="glass">
                                <i class="fas fa-shopping-cart" style="color: whitesmoke;"></i>
                                <span style="color: whitesmoke;">Cart</span>
                                <!-- <div class="cart-count">5</div> -->
                            </div>
                    </a>
                </div>
                <div class="user-profile">
                    <a href="/userprofile.html" style="text-decoration: none;">
                        <div class="glass">
                            <i class="fas fa-user" style="color: whitesmoke;"></i>
                            <span style="color: whitesmoke;" id="username">Aarav</span>
                        </div>
                    </a>
                </div>
            </div>
        </div>
        </div>
    </header>

    <section class="menu-hero">
        <div class="menu-hero-content">
            <h1>Our Menu</h1>
            <p>Discover a world of flavors crafted with passion</p>
        </div>
    </section>

    <div class="container">
        <div class="menu-nav glass">
            <div class="menu-nav-container">
                <div class="menu-nav-item" data-target="breakfast">Breakfast</div>
                <div class="menu-nav-item" data-target="coffee"><a href="#coffee">Coffee & Beverages</a></div>
                <div class="menu-nav-item" data-target="coffee"><a href="#pizza">Pizza</a></div>
                <div class="menu-nav-item" data-target="coffee"><a href="#pasta">Pasta</a></div>
                <div class="menu-nav-item" data-target="coffee"><a href="#sandwiches">Sandwiches</a></div>
                <div class="menu-nav-item" data-target="coffee"><a href="#quick">Quick Bites</a></div>
                <div class="menu-nav-item" data-target="coffee"><a href="#burgers">Burgers</a></div>
                <div class="menu-nav-item" data-target="coffee"><a href="#desserts">Desserts</a></div>
                <div class="menu-nav-item" data-target="coffee"><a href="#appetizers">Appetizers</a></div>
            </div>
        </div>
    </div>
    <!-- <div id="menu-container" class="menu-grid"></div> -->
    <div id="menuContainer"></div>

    

  

    <!-- <script>
        // Fetch menu data and populate the HTML
        async function fetchMenu() {
            try {
                const response = await fetch("http://localhost:5000/api/menu");
                const menuItems = await response.json();

                const menuContainer = document.getElementById("menu-container");
                menuContainer.innerHTML = ""; // Clear existing content

                menuItems.forEach(item => {
                    // Create menu item element
                    const menuItemDiv = document.createElement("div");
                    menuItemDiv.classList.add("menu-item", "glass", "animate-fade-in-up");

                    // Insert content dynamically
                    menuItemDiv.innerHTML = `
                        <div class="menu-item-image">
                            <img src="${item.image}" alt="${item.name}">
                        </div>
                        <div class="menu-item-content">
                            <div class="menu-item-badge">${item.badge || "Bestseller"}</div>
                            <h3 class="menu-item-title">${item.name}</h3>
                            <p class="menu-item-description">${item.description}</p>
                            <div class="menu-item-actions">
                                <div class="menu-item-price">${item.price}</div>
                                <button class="add-to-cart"><i class="fas fa-plus"></i></button>
                            </div>
                        </div>
                    `;

                    menuContainer.appendChild(menuItemDiv);
                });
            } catch (error) {
                console.error("Error fetching menu:", error);
            }
        }

        // Call function when page loads
        fetchMenu();
    </script> -->

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="img/logo.png" alt="Cafe Cactus Logo">
                    <h3>Cafe Cactus</h3>
                    <p>Delivering delicious meals with a focus on quality ingredients and exceptional taste.</p>
                </div>
                <div class="footer-links">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#">Home</a></li>
                        <li><a href="#">Browse Menu</a></li>
                        <li><a href="#">Track Order</a></li>
                        <li><a href="#">Contact Us</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h3>Information</h3>
                    <ul>
                        <li><a href="#">Terms & Conditions</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Cookie Policy</a></li>
                        <li><a href="#">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h3>Contact Us</h3>
                    <p><i class="fas fa-map-marker-alt"></i> SBR, Ahmedabad</p>
                    <p><i class="fas fa-phone"></i> +91 9876543210</p>
                    <p><i class="fas fa-envelope"></i> info@cafecactus.com</p>
                </div>
            </div>
            <div class="copyright">
                <p>Â© Cafe Cactus Copyright 2025, All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        
        document.addEventListener("DOMContentLoaded", async () => {
    const menuContainer = document.getElementById("menuContainer");
    // Initialize cart from localStorage or create empty cart
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    
    // Add CSS styles for quantity controls and cart sidebar
    const style = document.createElement('style');
    style.textContent = `
        /* Cart count styles */
        .cart-count {
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -10px;
            right: -10px;
            width: 20px;
            height: 20px;
            background-color: #ff3d00;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
        }

        .cart-btn {
            position: relative;
        }

        /* Quantity controls styling */
        .quantity-controls {
            display: flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            padding: 2px;
            height: 36px;
        }

        .quantity-decrease,
        .quantity-increase {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background-color: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .quantity-decrease:hover,
        .quantity-increase:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .quantity-value {
            margin: 0 10px;
            color: white;
            font-weight: 500;
            min-width: 20px;
            text-align: center;
        }

        /* Animation for quantity controls */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .quantity-controls {
            animation: fadeIn 0.3s ease-out;
        }

        /* Toast notification */
        #toast-notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
        }

        /* Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            height: 100vh;
            background-color: #1a1a1a;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            transition: right 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            color: white;
            overflow: hidden;
        }

        .cart-sidebar.active {
            right: 0;
        }

        .cart-sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            border-bottom: 1px solid #333;
            background-color: #222;
        }

        .cart-sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cart-sidebar-close {
            background: none;
            border: none;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            transition: background-color 0.2s;
        }

        .cart-sidebar-close:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .cart-sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .sidebar-cart-empty {
            text-align: center;
            padding: 40px 0;
            color: #999;
        }

        .sidebar-cart-empty i {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .sidebar-cart-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }

        .sidebar-cart-item-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            margin-right: 15px;
        }

        .sidebar-cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .sidebar-cart-item-details {
            flex: 1;
        }

        .sidebar-cart-item-title {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .sidebar-cart-item-price {
            color: #aaa;
            font-size: 0.9rem;
        }

        .sidebar-cart-item-actions {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }

        .sidebar-quantity-controls {
            display: flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            padding: 0 5px;
        }

        .sidebar-quantity-btn {
            background: none;
            border: none;
            color: white;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .sidebar-quantity-value {
            margin: 0 8px;
            font-size: 0.9rem;
        }

        .sidebar-cart-item-remove {
            color: #ff3d00;
            background: none;
            border: none;
            margin-left: 10px;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .sidebar-cart-item-remove:hover {
            opacity: 1;
        }

        .cart-sidebar-footer {
            padding: 20px;
            border-top: 1px solid #333;
            background-color: #222;
        }

        .cart-sidebar-subtotal {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .cart-sidebar-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .view-cart-btn,
        .checkout-btn {
            padding: 12px;
            border: none;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            display: block;
        }

        .view-cart-btn {
            background-color: rgba(255,255,255,0.1);
            color: white;
        }

        .view-cart-btn:hover {
            background-color: rgba(255,255,255,0.2);
        }

        .checkout-btn {
            background-color: #4CAF50;
            color: white;
        }

        .checkout-btn:hover {
            background-color: #3e8e41;
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .cart-icon-btn {
            cursor: pointer;
        }
    `;
    document.head.appendChild(style);

    // Create cart sidebar structure
    createCartSidebar();

    try {
        const response = await fetch("http://localhost:5000/api/menu");
        const menuItems = await response.json();

        if (!menuItems.length) {
            menuContainer.innerHTML = "<p>No menu items available.</p>";
            return;
        }

        // Group items by category
        const categories = {};
        menuItems.forEach(item => {
            if (!categories[item.category]) {
                categories[item.category] = [];
            }
            categories[item.category].push(item);
        });

        // Generate sections dynamically
        for (const [category, items] of Object.entries(categories)) {
            const section = document.createElement("section");
            section.classList.add("menu-section");
            section.id = category.toLowerCase().replace(/\s+/g, "-"); // Convert category name to ID

            section.innerHTML = `
                <div class="container">
                    <div class="section-header animate-fade-in">
                        <h2>${category}</h2>
                        <br><br>
                        <p>Explore our delicious ${category.toLowerCase()} options!</p>
                    </div>
                    <div class="menu-grid"></div>
                </div>
            `;

            const menuGrid = section.querySelector(".menu-grid");

            // Add menu items to the section
            items.forEach(item => {
                const menuItem = document.createElement("div");
                menuItem.classList.add("menu-item", "glass", "animate-fade-in-up");

                // Check if this item is already in the cart
                const cartItem = cart.find(cartItem => cartItem.id === item._id);
                
                // Determine whether to show add button or quantity controls
                let actionButtonHtml;
                if (cartItem) {
                    actionButtonHtml = `
                        <div class="quantity-controls">
                            <button class="quantity-decrease" data-id="${item._id}">
                                <i class="fas fa-minus"></i>
                            </button>
                            <span class="quantity-value">${cartItem.quantity}</span>
                            <button class="quantity-increase" data-id="${item._id}">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    `;
                } else {
                    actionButtonHtml = `
                        <button class="add-to-cart" data-id="${item._id}">
                            <i class="fas fa-plus"></i>
                        </button>
                    `;
                }

                menuItem.innerHTML = `
                    <div class="menu-item-image">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="menu-item-content">
                        ${item.bestseller ? `<div class="menu-item-badge">Bestseller</div>` : ""}
                        <h3 class="menu-item-title">${item.name}</h3>
                        <p class="menu-item-description">${item.description}</p>
                        <div class="menu-item-actions">
                            <div class="menu-item-price">${item.price}</div>
                            ${actionButtonHtml}
                        </div>
                    </div>
                `;

                menuGrid.appendChild(menuItem);
            });

            menuContainer.appendChild(section);
        }
        
        // Update UI after menu is loaded
        updateCartCount();
        updateCartSidebar();
        
    } catch (error) {
        console.error("Error fetching menu items:", error);
        menuContainer.innerHTML = "<p>Failed to load menu.</p>";
    }

    // Make the cart icon clickable to show sidebar
    const cartIcon = document.querySelector(".cart-btn");
    if (cartIcon) {
        cartIcon.classList.add("cart-icon-btn");
        cartIcon.addEventListener("click", function(e) {
            e.preventDefault();
            toggleCartSidebar();
        });
    }

    // Handle all click events for cart functionality
    document.addEventListener("click", (e) => {
        // Adding items to cart (for first time)
        if (e.target.classList.contains("add-to-cart") || 
            (e.target.parentElement && e.target.parentElement.classList.contains("add-to-cart"))) {
            
            // Find the actual button element
            const button = e.target.classList.contains("add-to-cart") ? 
                e.target : e.target.parentElement;
            
            // Get the menu item id
            const itemId = button.getAttribute("data-id");
            
            // Find the menu item container
            const menuItem = button.closest(".menu-item");
            const itemName = menuItem.querySelector(".menu-item-title").textContent;
            const itemPrice = menuItem.querySelector(".menu-item-price").textContent;
            const itemImage = menuItem.querySelector(".menu-item-image img").src;
            
            // Check if item is already in cart
            const existingItemIndex = cart.findIndex(item => item.id === itemId);
            
            if (existingItemIndex > -1) {
                // Increment quantity if item already exists
                cart[existingItemIndex].quantity += 1;
            } else {
                // Add new item to cart
                cart.push({
                    id: itemId,
                    name: itemName,
                    price: itemPrice,
                    image: itemImage,
                    quantity: 1
                });
            }
            
            // Save cart to localStorage
            localStorage.setItem("cart", JSON.stringify(cart));
            
            // Show confirmation message
            showToast(`${itemName} added to cart!`);
            
            // Update cart count and replace add button with quantity controls
            updateCartCount();
            updateCartSidebar();
            
            // Replace add button with quantity controls
            const addButton = menuItem.querySelector(".add-to-cart");
            const actionsDiv = menuItem.querySelector(".menu-item-actions");
            const cartItem = cart.find(item => item.id === itemId);
            
            if (cartItem && addButton) {
                // Create quantity controls
                const quantityControls = document.createElement("div");
                quantityControls.className = "quantity-controls";
                quantityControls.innerHTML = `
                    <button class="quantity-decrease" data-id="${itemId}">
                        <i class="fas fa-minus"></i>
                    </button>
                    <span class="quantity-value">${cartItem.quantity}</span>
                    <button class="quantity-increase" data-id="${itemId}">
                        <i class="fas fa-plus"></i>
                    </button>
                `;
                
                // Replace add button with quantity controls
                addButton.remove();
                actionsDiv.appendChild(quantityControls);
            }
            
            // Show cart sidebar
            toggleCartSidebar(true);
        }
        
        // Handle quantity increase button
        if (e.target.classList.contains("quantity-increase") || 
            (e.target.parentElement && e.target.parentElement.classList.contains("quantity-increase"))) {
            
            const button = e.target.classList.contains("quantity-increase") ? 
                e.target : e.target.parentElement;
            const itemId = button.getAttribute("data-id");
            
            // Find item in cart
            const cartItem = cart.find(item => item.id === itemId);
            if (cartItem) {
                cartItem.quantity += 1;
                localStorage.setItem("cart", JSON.stringify(cart));
                
                // Update the displayed quantity
                const menuItem = button.closest(".menu-item");
                const quantityValue = menuItem.querySelector(".quantity-value");
                if (quantityValue) {
                    quantityValue.textContent = cartItem.quantity;
                }
                
                updateCartCount();
                updateCartSidebar();
                showToast(`Item quantity updated!`);
            }
        }
        
        // Handle quantity decrease button
        if (e.target.classList.contains("quantity-decrease") || 
            (e.target.parentElement && e.target.parentElement.classList.contains("quantity-decrease"))) {
            
            const button = e.target.classList.contains("quantity-decrease") ? 
                e.target : e.target.parentElement;
            const itemId = button.getAttribute("data-id");
            
            // Find item in cart
            const cartItem = cart.find(item => item.id === itemId);
            if (cartItem) {
                if (cartItem.quantity > 1) {
                    cartItem.quantity -= 1;
                    localStorage.setItem("cart", JSON.stringify(cart));
                    
                    // Update the displayed quantity
                    const menuItem = button.closest(".menu-item");
                    const quantityValue = menuItem.querySelector(".quantity-value");
                    if (quantityValue) {
                        quantityValue.textContent = cartItem.quantity;
                    }
                    
                    updateCartCount();
                    updateCartSidebar();
                    showToast(`Item quantity updated!`);
                } else {
                    // Remove item if quantity becomes 0
                    const itemIndex = cart.findIndex(item => item.id === itemId);
                    if (itemIndex > -1) {
                        const itemName = cart[itemIndex].name;
                        cart.splice(itemIndex, 1);
                        localStorage.setItem("cart", JSON.stringify(cart));
                        
                        // Replace quantity controls with add button
                        const menuItem = button.closest(".menu-item");
                        const actionsDiv = menuItem.querySelector(".menu-item-actions");
                        const quantityControls = menuItem.querySelector(".quantity-controls");
                        
                        if (quantityControls && actionsDiv) {
                            quantityControls.remove();
                            
                            // Create new add button
                            const addButton = document.createElement("button");
                            addButton.className = "add-to-cart";
                            addButton.setAttribute("data-id", itemId);
                            addButton.innerHTML = '<i class="fas fa-plus"></i>';
                            
                            actionsDiv.appendChild(addButton);
                        }
                        
                        updateCartCount();
                        updateCartSidebar();
                        showToast(`${itemName} removed from cart!`);
                    }
                }
            }
        }
        
        // Handle sidebar quantity increase
        if (e.target.classList.contains("sidebar-quantity-increase") || 
            (e.target.parentElement && e.target.parentElement.classList.contains("sidebar-quantity-increase"))) {
            
            const button = e.target.classList.contains("sidebar-quantity-increase") ? 
                e.target : e.target.parentElement;
            const itemId = button.getAttribute("data-id");
            
            // Find item in cart
            const cartItem = cart.find(item => item.id === itemId);
            if (cartItem) {
                cartItem.quantity += 1;
                localStorage.setItem("cart", JSON.stringify(cart));
                
                updateCartCount();
                updateCartSidebar();
                updateMenuItemQuantity(itemId);
            }
        }
        
        // Handle sidebar quantity decrease
        if (e.target.classList.contains("sidebar-quantity-decrease") || 
            (e.target.parentElement && e.target.parentElement.classList.contains("sidebar-quantity-decrease"))) {
            
            const button = e.target.classList.contains("sidebar-quantity-decrease") ? 
                e.target : e.target.parentElement;
            const itemId = button.getAttribute("data-id");
            
            // Find item in cart
            const cartItem = cart.find(item => item.id === itemId);
            if (cartItem) {
                if (cartItem.quantity > 1) {
                    cartItem.quantity -= 1;
                    localStorage.setItem("cart", JSON.stringify(cart));
                    
                    updateCartCount();
                    updateCartSidebar();
                    updateMenuItemQuantity(itemId);
                } else {
                    // Remove item if quantity becomes 0
                    removeFromCart(itemId);
                }
            }
        }
        
        // Handle sidebar remove item
        if (e.target.classList.contains("sidebar-cart-item-remove") || 
            (e.target.parentElement && e.target.parentElement.classList.contains("sidebar-cart-item-remove"))) {
            
            const button = e.target.classList.contains("sidebar-cart-item-remove") ? 
                e.target : e.target.parentElement;
            const itemId = button.getAttribute("data-id");
            
            removeFromCart(itemId);
        }
        
        // Close cart sidebar when clicking overlay
        if (e.target.classList.contains("overlay")) {
            toggleCartSidebar(false);
        }
        
        // Close cart sidebar
        if (e.target.classList.contains("cart-sidebar-close") || 
            (e.target.parentElement && e.target.parentElement.classList.contains("cart-sidebar-close"))) {
            toggleCartSidebar(false);
        }
    });
    
    // Function to remove an item from the cart
    function removeFromCart(itemId) {
        const itemIndex = cart.findIndex(item => item.id === itemId);
        if (itemIndex > -1) {
            const itemName = cart[itemIndex].name;
            cart.splice(itemIndex, 1);
            localStorage.setItem("cart", JSON.stringify(cart));
            
            // Update menu item UI
            const menuItem = document.querySelector(`.menu-item .add-to-cart[data-id="${itemId}"]`)?.closest('.menu-item') ||
                            document.querySelector(`.menu-item .quantity-decrease[data-id="${itemId}"]`)?.closest('.menu-item');
            
            if (menuItem) {
                const actionsDiv = menuItem.querySelector(".menu-item-actions");
                const quantityControls = menuItem.querySelector(".quantity-controls");
                
                if (quantityControls && actionsDiv) {
                    quantityControls.remove();
                    
                    // Create new add button
                    const addButton = document.createElement("button");
                    addButton.className = "add-to-cart";
                    addButton.setAttribute("data-id", itemId);
                    addButton.innerHTML = '<i class="fas fa-plus"></i>';
                    
                    actionsDiv.appendChild(addButton);
                }
            }
            
            updateCartCount();
            updateCartSidebar();
            showToast(`${itemName} removed from cart!`);
        }
    }
    
    // Function to update menu item quantity display
    function updateMenuItemQuantity(itemId) {
        const cartItem = cart.find(item => item.id === itemId);
        if (!cartItem) return;
        
        const menuItem = document.querySelector(`.menu-item .quantity-decrease[data-id="${itemId}"]`)?.closest('.menu-item');
        if (menuItem) {
            const quantityValue = menuItem.querySelector(".quantity-value");
            if (quantityValue) {
                quantityValue.textContent = cartItem.quantity;
            }
        }
    }

    // Function to create cart sidebar structure
    function createCartSidebar() {
        // Create overlay
        const overlay = document.createElement("div");
        overlay.className = "overlay";
        document.body.appendChild(overlay);
        
        // Create cart sidebar
        const cartSidebar = document.createElement("div");
        cartSidebar.className = "cart-sidebar";
        cartSidebar.innerHTML = `
            <div class="cart-sidebar-header">
                <h3 class="cart-sidebar-title">
                    <i class="fas fa-shopping-cart"></i>
                    Your Cart
                </h3>
                <button class="cart-sidebar-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="cart-sidebar-content">
                <!-- Cart items will be added here -->
            </div>
            <div class="cart-sidebar-footer">
                <div class="cart-sidebar-subtotal">
                    <span>Subtotal:</span>
                    <span id="cart-subtotal">â¹0.00</span>
                </div>
                <div class="cart-sidebar-buttons">
                    <a href="/cart.html" class="view-cart-btn">View Cart</a>
                    <a href="/cart.html" class="checkout-btn">Checkout</a>
                </div>
            </div>
        `;
        document.body.appendChild(cartSidebar);
    }
    
    // Function to toggle cart sidebar
    function toggleCartSidebar(show) {
        const sidebar = document.querySelector(".cart-sidebar");
        const overlay = document.querySelector(".overlay");
        
        if (!sidebar || !overlay) return;
        
        if (show === true) {
            sidebar.classList.add("active");
            overlay.classList.add("active");
        } else if (show === false) {
            sidebar.classList.remove("active");
            overlay.classList.remove("active");
        } else {
            sidebar.classList.toggle("active");
            overlay.classList.toggle("active");
        }
    }
    
    // Function to update cart sidebar content
    function updateCartSidebar() {
        const cartContent = document.querySelector(".cart-sidebar-content");
        const subtotalElement = document.getElementById("cart-subtotal");
        
        if (!cartContent || !subtotalElement) return;
        
        if (cart.length === 0) {
            cartContent.innerHTML = `
                <div class="sidebar-cart-empty">
                    <i class="fas fa-shopping-cart"></i>
                    <h4>Your cart is empty</h4>
                    <p>Add items to get started!</p>
                </div>
            `;
            subtotalElement.textContent = "â¹0.00";
            return;
        }
        
        // Calculate subtotal
        const subtotal = cart.reduce((total, item) => {
            const price = parseFloat(item.price.replace(/[^\d.]/g, ''));
            return total + (price * item.quantity);
        }, 0);
        
        // Update subtotal
        subtotalElement.textContent = `â¹${subtotal.toFixed(2)}`;
        
        // Generate cart items HTML
        let cartItemsHtml = '';
        
        cart.forEach(item => {
            cartItemsHtml += `
                <div class="sidebar-cart-item">
                    <div class="sidebar-cart-item-image">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="sidebar-cart-item-details">
                        <div class="sidebar-cart-item-title">${item.name}</div>
                        <div class="sidebar-cart-item-price">${item.price} Ã ${item.quantity}</div>
                        <div class="sidebar-cart-item-actions">
                            <div class="sidebar-quantity-controls">
                                <button class="sidebar-quantity-btn sidebar-quantity-decrease" data-id="${item.id}">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="sidebar-quantity-value">${item.quantity}</span>
                                <button class="sidebar-quantity-btn sidebar-quantity-increase" data-id="${item.id}">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <button class="sidebar-cart-item-remove" data-id="${item.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        });
        
        cartContent.innerHTML = cartItemsHtml;
    }

    // Function to update cart count
    function updateCartCount() {
        // Create cart count element if it doesn't exist
        let cartBtn = document.querySelector(".cart-btn .glass");
        if (!cartBtn) return; // Exit if element doesn't exist

        let cartCount = document.querySelector(".cart-count");
        
        if (!cartCount) {
            cartCount = document.createElement("div");
            cartCount.classList.add("cart-count");
            cartBtn.appendChild(cartCount);
        }
        
        // Calculate total quantity
        const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
        
        // Update count display
        if (totalItems > 0) {
            cartCount.textContent = totalItems;
            cartCount.style.display = "flex";
        } else {
            cartCount.style.display = "none";
        }
    }

    // Function to show toast message
    function showToast(message) {
        // Create toast if it doesn't exist
        let toast = document.getElementById("toast-notification");
        if (!toast) {
            toast = document.createElement("div");
            toast.id = "toast-notification";
            document.body.appendChild(toast);
        }
        
        // Set message and show toast
        toast.textContent = message;
        toast.style.opacity = "1";
        
        // Hide toast after 3 seconds
        setTimeout(() => {
            toast.style.opacity = "0";
        }, 3000);
    }

    // Initialize username display
    const fetchUserName = localStorage.getItem("username");
    if (fetchUserName && document.getElementById("username")) {
        document.getElementById("username").innerHTML = fetchUserName;
    }
});

    </script>

</body>

</html>